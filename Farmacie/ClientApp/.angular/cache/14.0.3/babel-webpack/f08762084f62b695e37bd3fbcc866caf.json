{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../auth.service\";\nimport * as i4 from \"../helpers\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\n\nfunction PacientComponent_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction PacientComponent_tr_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 13)(2, \"input\", 14);\n    i0.ɵɵlistener(\"ngModelChange\", function PacientComponent_tr_27_Template_input_ngModelChange_2_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const pac_r3 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(pac_r3.selectat = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"td\", 15);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 16);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 17);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 16);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 17)(12, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function PacientComponent_tr_27_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const pac_r3 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.modificaClicked(pac_r3));\n    });\n    i0.ɵɵtext(13, \"Modifica\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const pac_r3 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", pac_r3.selectat);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", pac_r3.nume, \" \", pac_r3.prenume, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pac_r3.cnp);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.helpers.getData(pac_r3.data_Nastere));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pac_r3.telefon);\n  }\n}\n\nfunction PacientComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"p\");\n    i0.ɵɵtext(2, \"Nu exista date momentan\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nconst _c0 = function () {\n  return [\"/pacient\"];\n};\n\nexport let PacientComponent = /*#__PURE__*/(() => {\n  class PacientComponent {\n    constructor(http, baseUrl, router, authService, helpers) {\n      this.http = http;\n      this.baseUrl = baseUrl;\n      this.router = router;\n      this.authService = authService;\n      this.helpers = helpers;\n      this.pacientiNefiltrati = [];\n      this.pacienti = [];\n      if (!authService.esteConectat) this.router.navigate(['/conectare']);\n      if (!authService.esteFarmacist) this.router.navigate(['/']);\n      http.get(baseUrl + 'listapacienti').subscribe({\n        next: result => {\n          this.pacientiNefiltrati = result;\n          this.pacienti = this.pacientiNefiltrati;\n        }\n      });\n    }\n\n    filterPacs() {\n      if (this.filtruPacient) {\n        this.pacienti = this.pacientiNefiltrati.filter(pac => {\n          return this.getNumePrenume(pac).toLowerCase().includes(this.filtruPacient.toLowerCase()) || pac.cnp.includes(this.filtruPacient);\n        });\n      } else {\n        this.pacienti = this.pacientiNefiltrati;\n      }\n    }\n\n    getNumePrenume(pac) {\n      return pac.nume + \" \" + pac.prenume;\n    }\n\n    modificaClicked(pac) {\n      const queryParams = encodeURIComponent(JSON.stringify(pac));\n      const modifyPageUrl = `/pacient?pacient=${queryParams}`;\n      this.router.navigateByUrl(modifyPageUrl);\n    }\n\n    stergeClicked() {\n      const selectedRows = this.pacientiNefiltrati.filter(row => row.selectat);\n      selectedRows.forEach(row => {\n        const index = this.pacientiNefiltrati.indexOf(row);\n\n        if (index > -1) {\n          this.http.post(this.baseUrl + 'pacient/sterge', row).subscribe({\n            next: () => {}\n          });\n          this.pacientiNefiltrati.splice(index, 1);\n        }\n      });\n    }\n\n  }\n\n  PacientComponent.ɵfac = function PacientComponent_Factory(t) {\n    return new (t || PacientComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject('BASE_URL'), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.Helpers));\n  };\n\n  PacientComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PacientComponent,\n    selectors: [[\"app-fetch-data-pacienti\"]],\n    decls: 32,\n    vars: 6,\n    consts: [[\"id\", \"tableLabel\"], [4, \"ngIf\"], [1, \"container\", \"py-3\", 2, \"padding-left\", \"0px\"], [1, \"btn\", \"btn-primary\", 3, \"routerLink\"], [1, \"col\", \"col-lg-3\"], [1, \"form-floating\", \"mb-3\"], [\"type\", \"text\", \"id\", \"filtru\", \"name\", \"filtru\", \"placeholder\", \"Filtru pacient\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"input\"], [\"for\", \"denumire\"], [\"aria-labelledby\", \"tableLabel\", 1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"container py-3\", 4, \"ngIf\"], [1, \"btn\", \"btn-primary\", 2, \"float\", \"right\", 3, \"click\"], [1, \"container\", \"py-5\"], [\"width\", \"1%\", \"align\", \"center\"], [\"type\", \"checkbox\", 3, \"ngModel\", \"ngModelChange\"], [\"width\", \"30%\"], [\"width\", \"15%\"], [\"width\", \"10%\"], [1, \"btn\", \"btn-secondary\", \"btn-sm\", 3, \"click\"], [1, \"container\", \"py-3\"]],\n    template: function PacientComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h2\", 0);\n        i0.ɵɵtext(1, \"Pacienti\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(2, PacientComponent_p_2_Template, 3, 0, \"p\", 1);\n        i0.ɵɵelementStart(3, \"div\", 2)(4, \"button\", 3);\n        i0.ɵɵtext(5, \"Adauga pacient\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"div\", 5)(8, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function PacientComponent_Template_input_ngModelChange_8_listener($event) {\n          return ctx.filtruPacient = $event;\n        })(\"input\", function PacientComponent_Template_input_input_8_listener() {\n          return ctx.filterPacs();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"label\", 7);\n        i0.ɵɵtext(10, \"Filtru pacienti (Nume/CNP)\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(11, \"table\", 8)(12, \"thead\")(13, \"tr\")(14, \"th\");\n        i0.ɵɵtext(15, \"Selectat\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"th\");\n        i0.ɵɵtext(17, \"Nume\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"th\");\n        i0.ɵɵtext(19, \"CNP\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"th\");\n        i0.ɵɵtext(21, \"Data Nastere\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"th\");\n        i0.ɵɵtext(23, \"Telefon\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"th\");\n        i0.ɵɵtext(25, \"Actiuni\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(26, \"tbody\");\n        i0.ɵɵtemplate(27, PacientComponent_tr_27_Template, 14, 6, \"tr\", 9);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(28, PacientComponent_div_28_Template, 3, 0, \"div\", 10);\n        i0.ɵɵelementStart(29, \"button\", 11);\n        i0.ɵɵlistener(\"click\", function PacientComponent_Template_button_click_29_listener() {\n          return ctx.stergeClicked();\n        });\n        i0.ɵɵtext(30, \"Sterge\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(31, \"div\", 12);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", !ctx.pacienti);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.filtruPacient);\n        i0.ɵɵadvance(19);\n        i0.ɵɵproperty(\"ngForOf\", ctx.pacienti);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.pacienti.length == 0);\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i6.DefaultValueAccessor, i6.CheckboxControlValueAccessor, i6.NgControlStatus, i6.NgModel, i2.RouterLink],\n    encapsulation: 2\n  });\n  return PacientComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}